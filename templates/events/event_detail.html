{% extends "base.html" %}
{% load i18n %}

{% block title %}{{ event.name }}{% endblock %}

{% block content %}
<div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg">
    {% if messages %}
        <ul class="mb-4">
            {% for message in messages %}
                <li class="p-3 rounded-md {% if message.tags == 'success' %}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200{% elif message.tags == 'error' %}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200{% endif %}">
                    {{ message }}
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    <div class="flex flex-col md:flex-row items-center md:items-start gap-8">
        {% if event.image %}
            <img src="{{ event.image.url }}" alt="{{ event.name }}" class="w-full md:w-1/3 h-64 object-cover rounded-lg shadow-md">
        {% endif %}
        <div class="flex-1">
            <h1 class="text-4xl font-bold text-blue-600 dark:text-blue-400 mb-4">{{ event.name }}</h1>
            <p class="text-gray-700 dark:text-gray-300 text-lg mb-2">
                <span class="font-semibold">Date:</span> {{ event.date|date:"M d, Y" }}
            </p>
            <p class="text-gray-700 dark:text-gray-300 text-lg mb-2">
                <span class="font-semibold">Time:</span> {{ event.time|time:"P" }}
            </p>
            <p class="text-gray-700 dark:text-gray-300 text-lg mb-2">
                <span class="font-semibold">Location:</span> {{ event.location }}
            </p>
            <p class="text-gray-700 dark:text-gray-300 text-lg mb-2">
                <span class="font-semibold">Category:</span> {{ event.category.name|default:"N/A" }}
            </p>
            <p class="text-gray-700 dark:text-gray-300 text-lg mb-4">
                <span class="font-semibold">Organizer:</span> {{ event.organizer.first_name|default:event.organizer.email|default:"N/A" }}
            </p>
            <p class="text-gray-700 dark:text-gray-300 mb-6">{{ event.description }}</p>

            <h2 class="text-2xl font-bold text-blue-600 dark:text-blue-400 mb-3">Participants ({{ event.participants.count }})</h2>
            {% if event.participants.all %}
                <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
                    {% for participant in event.participants.all %}
                        <li>{{ participant.first_name|default:participant.email }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-gray-700 dark:text-gray-300">No participants yet.</p>
            {% endif %}

            {% if user.is_authenticated and (user.is_superuser or event.organizer == user) %}
            <div class="mt-8 flex space-x-4">
                <a href="{% url 'event_update' event.pk %}" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                    Edit Event
                </a>
                <a href="{% url 'event_delete' event.pk %}" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                    Delete Event
                </a>
            </div>
            {% endif %}

            <div class="mt-4">
                <a href="{% url 'event_list' %}" class="text-blue-500 hover:underline">Back to Event List</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}